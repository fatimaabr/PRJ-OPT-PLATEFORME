<!DOCTYPE html>
<html lang="en">

<head>
    <title>Projet optim</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- vendor css -->
    <link rel="stylesheet" href="assets/css/style.css">
	<script type="text/javascript" src="/eel.js"></script>
    
</head>
<body class="">
	<!-- [ Pre-loader ] start -->
	<div class="loader-bg">
		<div class="loader-track">
			<div class="loader-fill"></div>
		</div>
	</div>
	<!-- [ Pre-loader ] End -->
	<!-- [ navigation menu ] start -->
	<nav class="pcoded-navbar menu-light ">
		<div class="navbar-wrapper  ">
			<div class="navbar-content scroll-div " >
				
			
				
				<ul class="nav pcoded-inner-navbar ">
					<li class="nav-item pcoded-menu-caption">
					    <label>Bin Packing</label>
					</li>
					<li class="nav-item">
					    <a href="home.html" class="nav-link "><span class="pcoded-micon"><i class="feather icon-home"></i></span><span class="pcoded-mtext">Home</span></a>
					</li>
					
					<li class="nav-item pcoded-menu-caption">
					    <label>Algorithmes </label>
					</li>
					<li class="nav-item pcoded-hasmenu">
					    <a href="#!" class="nav-link "><span class="pcoded-micon"><i class="feather icon-box"></i></span><span class="pcoded-mtext">Méthodes exactes</span></a>
					    <ul class="pcoded-submenu">
					        <li><a href="bnb.html">Branch And Bound</a></li>
					        
					      
					    </ul>
					</li>
					<li class="nav-item pcoded-hasmenu">
					    <a href="#!" class="nav-link "><span class="pcoded-micon"><i class="feather icon-box"></i></span><span class="pcoded-mtext">Heuristiques  </span></a>
					    <ul class="pcoded-submenu">
					        <li><a href="heuristics.html">First-fit decreasing</a></li>
					        <li><a href="heuristics.html">First-fit increasing</a></li>
							<li><a href="heuristics.html">Best-fit</a></li>
							<li><a href="heuristics.html">Worst-fit</a></li>
							<li><a href="heuristics.html">Almost-worst-fit</a></li>
							<li><a href="heuristics.html">Next-fit</a></li>
					      
					    </ul>
					</li>
					<li class="nav-item pcoded-hasmenu">
					    <a href="#!" class="nav-link "><span class="pcoded-micon"><i class="feather icon-box"></i></span><span class="pcoded-mtext">Méta heuristiques</span></a>
					    <ul class="pcoded-submenu">
					        <li><a href="recuit_simule.html">Recuit simulé </a></li>
					        <li><a href="ag.html">Algorithme génétique</a></li>
							<li><a href="rechtabou.html">Algorithme génétique</a></li>
					      
					    </ul>
					</li>
					<li class="nav-item pcoded-hasmenu">
					    <a href="dashboard.html" class="nav-link "><span class="pcoded-micon"><i class="feather icon-box"></i></span><span class="pcoded-mtext">Graphes</span></a>
					</li>
				

				</ul>
				
			
				
			</div>
		</div>
	</nav>
	<!-- [ navigation menu ] end -->
	<!-- [ Header ] start -->
	<header class="navbar pcoded-header navbar-expand-lg navbar-light header-blue">
		
			
				<div class="m-header">
					<a class="mobile-menu" id="mobile-collapse" href="#!"><span></span></a>
					<a href="#!" class="b-brand">
						<!-- ========   change your logo hear   ============ -->
						<b style="font-weight: 700;">Projet optimisation</b>
					</a>
					<a href="#!" class="mob-toggler">
						<i class="feather icon-more-vertical"></i>
					</a>
				</div>
				<div class="collapse navbar-collapse">
					<ul class="navbar-nav mr-auto">
						<li class="nav-item">
							<a href="#!" class="pop-search"><i class="feather icon-search"></i></a>
							<div class="search-bar">
								<input type="text" class="form-control border-0 shadow-none" placeholder="Search hear">
								<button type="button" class="close" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
						</li>
					</ul>
				
				</div>
				
			
	</header>
	<!-- [ Header ] end -->
	
	

<!-- [ Main Content ] start -->
<div class="pcoded-main-container">
    <div class="pcoded-content">
        <!-- [ breadcrumb ] start -->
        <div class="page-header">
            <div class="page-block">
                <div class="row align-items-center">
                    <div class="col-md-12">
                        <div class="page-header-title">
                            <h5 class="m-b-10">Méta Heuristiques</h5>
                        </div>
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="home.html"><i class="feather icon-home"></i></a></li>
                            <li class="breadcrumb-item"><a href="#!">Algorithme génétique</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- [ breadcrumb ] end -->
        <!-- [ Main Content ] start -->
        <div class="row">
			<div class="col-md-3 " >
				<div class="card" >
                    <div class="card-header">
                        <h5>Les objets</h5>
                    </div>
                    <div class="card-body table-border-style"> 
                        <div class="table-responsive objects" style="height : 460px ">
                            <table class="table table-hover"  >
                                <thead>
                                    <tr>
                                      
                                        <th>Numéro</th>
                                        <th>Poids</th>
                                    </tr>
                                </thead>
                                <tbody class="body_objets">
                                 
                                   
                                </tbody>
                            </table>
                        </div>
						
                    </div>
                </div>
			</div>
		    <div class="col-md-9">
				<div class="card">
					<div class="card-header d-flex justify-content-between">
                        <h5 class="mt-2">Ajouter une instance </h5>
					
						<div class="custom-file">
							<input type="file" class="custom-file-input" id="inputGroupFile03" onchange="loadFile(this.files[0])">
							<label class="custom-file-label" for="inputGroupFile03">Choose file</label>
						</div>
					
					</div>
                    <div class="card-body table-border-style">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Capacité du Bin</th>
                                        <th>Nombre des objets</th>
                                        <th>Poids des objets</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr> 
                                        <td id="capacite">vide</td>
                                        <td id="NB">vide</td>
                                        <td id="Poids">vide</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
						<h6 class="mt-2">Les paramétres de l'algorithme</h6>
							<div class="table-responsive mt-5">
								<table class="table table-hover">
									<thead>
										<tr>
										  
											<th >POPULATION SIZE</th>
											<th>MAX GENERATIONS</th>
											<th>MAX NO CHANGE</th>
											<th>TOURNAMENT SIZE</th>
											<th>MUTATION RATE</th>
											<th>CROSSOVER RATE</th>
											
										</tr>
									</thead>
									<tbody>
										<tr>
											
											<td>
												<input type="number" class="form-control" id="POPSZ" value="0">
											</td>
											<td>
												<input type="number" class="form-control" id="MAXGEN" value="0">
											</td>
											<td>
												<input type="number" class="form-control" id="MAXNCHG" value="0">
											</td>
											<td>
												<input type="number" class="form-control" id="TOURSZ" value="0">
											</td>
											<td>
												<input type="number" class="form-control" id="MUTRT" value="0">
											</td>
											<td>
												<input type="number" class="form-control" id="CRRT" value="0">
											</td>
										</tr>
									  
									</tbody>
									
								</table>
							</div>
							
                    </div>
					<div class="card-body d-flex justify-content-center">
						<button type="button" class="btn  btn-success col-sm-6" id="btn_run_RS" onclick="agjs()" >Résoudre le probléme </button>
					</div>
                </div>     
            </div>
			<div class="col-md-12">
				<div class="card">
					<div class="card-header">
						<h5>Solution Algorithme génétique </h5>
					</div>
					<div class="card-body">
						<div class="table-responsive ">
							<table class="table table-hover">
								<thead>
									<tr>
										<th >Nombre des bins </th>
										<th>Temps d'exécution</th>
										<th></th>
									</tr>
								</thead>
								<tbody>
									<tr>
										
										<td id="sol_bins" >
											
										</td>

										<td id="time">
										
										</td>
										
									</tr>
								  
								</tbody>
								
							</table>
						</div>
					</div>
					<div class="card-footer "></div>
					<div class="col-md-9 " style ="margin: auto;" >  
						<div class="card"  >
							<div style = "width: fit-content;" class="card-footer pt-3 table-aff">
								<h6>L'affectation des objets</h6>
								<table class="table table-hover mt-4 table-stripped " >
									<thead>
										<tr>
											<th class="col-sm-2">Numéro du bin  </th>
											<th class="col-sm-2">Les objets affectés  </th>
											<th class="col-sm-2">Capacité remplie</th>
											<th class="col-sm-6">Remplissage du Bin</th>
										</tr>
									</thead>
									
										<tbody class="affectation col-md-9" >
										
									  
										</tbody>
								
								
									
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
        </div>
		<!-- [ Main Content ] end -->
    </div>
</div>

    <!-- Required Js -->
    <script src="assets/js/vendor-all.min.js"></script>
    <script src="assets/js/plugins/bootstrap.min.js"></script>
    <script src="assets/js/ripple.js"></script>
    <script src="assets/js/pcoded.min.js"></script>
	<script>
	
	var capacite = 0 ; 
		var items = [] ; 
		var nombre_items = 0 ; 
		var solution = [] ; 
		
		async function loadFile(file) {
			let text = await (new Response(file)).text();
			var list= text.split('\n') ;
			var list = list.map(function (x) { return parseInt(x); });
			capacite =  list[1]  ; 
			nombre_items = list[0] ; 
			items = list.slice(2 , list[0]+2 ) ;
			var objets = $(".body_objets")[0] ; 
			var nb = $("#NB")[0] ; 
			var c = $("#capacite")[0] ; 
			var poids = $("#Poids")[0] ; 
		
			poids.innerHTML = Math.min (...items) + " < p < " + Math.max (...items) ; 
			c.innerHTML = capacite ; 
			nb.innerHTML = nombre_items ; 
			for(var i = 0 ; i <items.length ; i++) {
				var tr = document.createElement('tr') ; 
				tr.innerHTML=" <td> " +i + " </td> <td> " + items[i]+ "</td>" ; 
				objets.append (tr) ; 
			}
			
			document.getElementById("POPSZ").value =50 ; 
			document.getElementById("MAXGEN").value =250 ; 
			document.getElementById("MAXNCHG").value =50 ; 
			document.getElementById("TOURSZ").value =20 ; 
			document.getElementById("MUTRT").value =0.3 ; 
			document.getElementById("CRRT").value =0.6 ;

			document.getElementById("sol_bins").innerHTML = "" ; 
			document.getElementById("time").innerHTML ="" ; 
			 
		}
		async function loadtable(tableau){
        var obj = $(".body_objets2")[0] ;
        for(var i = 0 ; i <tableau.length ; i++) {
        var tr = document.createElement('tr') ; 
        tr.innerHTML=" <td> " +i + " </td> <td> " + tableau[i]+ "</td>" ; 
        obj.append (tr) ; 
    }
 }
          async function agjs(){
			//eel.agpy(capacite,items);
			var tab =[];
            tab  = await eel.agpy(items,capacite)();
            var c = [];
            c = tab[2];
            console.log(" configuration : "+c);
            loadtable(c);
			jsaffich(tab[0],tab[1]);

			//-------------------
			var list_bins  = Array.from(set);
            var weights = new Array(list_bins.length); 
    weights.fill(0) ;
    var affectation = new Array( tab[0]) ; 
    for(var k = 0 ; k< tab[0] ; k++ ) {
        affectation[k] = [] ;  

    }
    for ( var i= 0 ; i < affectation.length ; i++ ) {
        for(var j = 0 ; j< tab[2].length; j++) {
            if(tab[2][j]==list_bins[i]) {
                affectation[i].push(j) ; 
                weights[i] += items[j] ; 
            }
        }
        
    }
  console.log(weights) ; 
    var aff = $('.affectation')[0] ; 
    for(i = 0 ; i<affectation.length ; i++ ) {
        var elem = document.createElement('tr') ; 
        p = ( weights[i]*100 ) / capacite ; 
        elem.innerHTML = "	<td > " + i + " </td> <td > " + affectation[i] + "  </td> <td>  " +weights[i]+"  </td>  <td class='pr-4'><div class='progress mr-4 mt-2' style='height: 20px;'><div class='progress-bar' role='progressbar' style='width: " +p + "25%;' aria-valuenow='25' aria-valuemin='0' aria-valuemax='100'> "+p+" %</div></div></td>" ;
        aff.append(elem) ;  

    }
    document.getElementById("sol_bins").innerHTML = RS_sol[0] ; 
    document.getElementById("time").innerHTML = RS_sol[1] + " secondes" ; 
    console.log("best = "+RS_sol[2]);
    loadtable(RS_sol[2]);
		}
		
		eel.expose(jsaffich); // Expose this function to Python
		async function jsaffich(a,t) {
			document.getElementById("sol_bins").innerHTML = a ; 
			document.getElementById("time").innerHTML = t + " secondes" ;
		}
		
		
		
			 
						</script>

<!-- Apex Chart -->
<script src="assets/js/plugins/apexcharts.min.js"></script>



</body>

</html>
